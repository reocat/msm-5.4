// SPDX-License-Identifier: (GPL-2.0 OR MIT)
/*
 * Copyright (C) 2021 Shrirang Bagul <shrirang.bagul@canonical.com>
 */

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/leds/common.h>
#include "imx6sx-x6med35-som.dtsi"

/ {
	model = "Honeywell i.MX6SX X6Med35 PDK";
	compatible = "Honeywell,x6med35-pdk", "fsl,imx6sx";

	aliases {
		rtc0 = &rtc;
		rtc1 = &snvs_rtc;
	};

	beeper {
		compatible = "pwm-beeper";
		pwms = <&pwm4 0 5000000 0>;
	};

	chosen {
		stdout-path = &uart1;
	};

	leds {
		compatible = "gpio-leds";

		dl1 {
			color = <LED_COLOR_ID_YELLOW>;
			gpios = <&led_expander 0 GPIO_ACTIVE_LOW>;
		};

		dl2 {
			color = <LED_COLOR_ID_BLUE>;
			gpios = <&led_expander 1 GPIO_ACTIVE_LOW>;
		};

		dl3 {
			color = <LED_COLOR_ID_GREEN>;
			gpios = <&led_expander 2 GPIO_ACTIVE_LOW>;
		};

		dl4 {
			color = <LED_COLOR_ID_GREEN>;
			gpios = <&led_expander 3 GPIO_ACTIVE_LOW>;
		};

		dl5 {
			color = <LED_COLOR_ID_GREEN>;
			gpios = <&led_expander 4 GPIO_ACTIVE_LOW>;
		};

		dl6 {
			color = <LED_COLOR_ID_GREEN>;
			gpios = <&led_expander 5 GPIO_ACTIVE_LOW>;
		};

		dl7 {
			color = <LED_COLOR_ID_GREEN>;
			gpios = <&led_expander 6 GPIO_ACTIVE_LOW>;
		};

		dl8 {
			color = <LED_COLOR_ID_GREEN>;
			gpios = <&led_expander 7 GPIO_ACTIVE_LOW>;
		};
	};

	reg_usb_otg1_vbus: regulator-usb-otg1-vbus {
		compatible = "regulator-fixed";
		pinctrl-0 = <&pinctrl_usb_vbus>;
		pinctrl-names = "default";
		regulator-name = "vbus_usb_pwr_5v";
		regulator-min-microvolt = <5000000>;
		regulator-max-microvolt = <5000000>;
		gpio = <&gpio4 18 GPIO_ACTIVE_HIGH>;
		enable-active-high;
	};

	reg_wf_1v8: regulator-wf-1v8 {
		compatible = "regulator-fixed";
		regulator-name = "wifi_io_power";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		regulator-always-on;
	};

	reg_wifi_power: regulator-wifi-power {
		compatible = "regulator-fixed";
		regulator-name = "wifi_power";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		gpio = <&gpio2 10 GPIO_ACTIVE_HIGH>;
		enable-active-high;
		regulator-always-on;
		startup-delay-us = <10000>;
		off-on-delay-us = <12000>;
	};

	reg_bt_power: regulator-bt-power {
		compatible = "regulator-fixed";
		regulator-name = "bt_power";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		gpio = <&gpio1 2 GPIO_ACTIVE_HIGH>;
		enable-active-high;
		regulator-always-on;
		startup-delay-us = <10000>;
		off-on-delay-us = <12000>;
	};

	/*
	sound {
		compatible = "fsl,imx6sx-x6med35som-nau8822", "fsl,imx-audio-nau8822";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_hp>;
		model = "wm8962-audio";
		ssi-controller = <&ssi2>;
		audio-codec = <&codec>;
		audio-routing =
			"Headphone Jack", "HPOUTL",
			"Headphone Jack", "HPOUTR",
			"Ext Spk", "SPKOUTL",
			"Ext Spk", "SPKOUTR",
			"AMIC", "MICBIAS",
			"IN3R", "AMIC";
		mux-int-port = <2>;
		mux-ext-port = <3>;
	};
	*/
};

&audmux {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_audmux>;
	status = "okay";
};

&fec1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_enet1>;
	phy-mode = "rgmii-id";
	phy-handle = <&ethphy0>;
	phy-reset-gpios = <&gpio2 4 GPIO_ACTIVE_LOW>;
	phy-reset-duration = <20>;
	status = "okay";

	mdio {
		#address-cells = <1>;
		#size-cells = <0>;

		ethphy0: ethernet-phy@1 {
			compatible = "ethernet-phy-ieee802.3-c22";
			reg = <1>;
			micrel,led-mode = <0>;
		};
	};
};

&fec2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_enet2>;
	phy-mode = "rgmii-id";
	phy-handle = <&ethphy1>;
	phy-reset-gpios = <&gpio2 2 GPIO_ACTIVE_LOW>;
	phy-reset-duration = <20>;
	status = "okay";

	mdio {
		#address-cells = <1>;
		#size-cells = <0>;

		ethphy1: ethernet-phy@2 {
			compatible = "ethernet-phy-ieee802.3-c22";
			reg = <2>;
			micrel,led-mode = <0>;
		};
	};
};

&i2c1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c1>;
	clock-frequency = <100000>;
	status = "okay";

	rtc: rtc@68 {
		compatible = "st,m41t82";
		reg = <0x68>;
	};

	codec: nau8822@1a {
		compatible = "nuvoton,nau8822";
		reg = <0x1a>;
		clocks = <&clks IMX6SX_CLK_AUDIO>;
	};
};

&i2c2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c2>;
	clock-frequency = <1000000>;
	status = "okay";

	eeeprom: eeeprom@52 {
		compatible = "microchip,24lc32ac", "atmel,24c32";
		reg = <0x52>;
		page-size = <32>;
	};
};

&i2c3 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c3>;
	clock-frequency = <400000>;
	status = "okay";

	gpio_exp_20: gpio@20 {
		compatible = "ti,tca6416";
		reg = <0x20>;
		#gpio-cells = <2>;
		gpio-controller;
		interrupt-controller;
		interrupt-parent = <&gpio3>;
		interrupts = <0 IRQ_TYPE_EDGE_FALLING>;
		gpio-line-names =
			"port1_3v3_pwr_ctl", "port2_3v3_pwr_ctl",
			"common_port1_nrst", "common_port2_nrst",
			"board_id_1", "board_id_2", "board_id_3",
			"board_id_4", "lte_igt", "lte_radio_usb_ctrl",
			"lte_pwr_en", "lte_emergency_off", "lte_uart_dtr",
			"lte_vdd5v_en",	"cam_1v8_en", "cam_2v8_en";
	};

	led_expander: led-controller@21 {
		compatible = "ti,tca6408";
		reg = <0x21>;
		vcc-supply = <&reg_vdd_3v3>;
		gpio-controller;
		#gpio-cells = <2>;
	};
};

&pwm4 {
	#pwm-cells = <2>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pwm4>;
	status = "okay";
};

&qspi2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_qspi2>;
	status = "okay";

	flash0: w25q128@0 {
		#address-cells = <1>;
		#size-cells = <1>;
		compatible = "winbond,w25q128", "jedec,spi-nor";
		spi-max-frequency = <15625000>;
		reg = <0>;
	};
};

&snvs_poweroff {
	status = "okay";
};

&ssi2 {
	status = "okay";
};

&usbotg1 {
	vbus-supply = <&reg_usb_otg1_vbus>;

	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usb_otg1_id>;
	srp-disable;
	hnp-disable;
	adp-disable;
	dr_mode = "otg";
	status = "okay";
};

&usbphy1 {
	fsl,tx-d-cal = <106>;
};

/* Cortex-A9 Debug UART */
&uart1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart1>;
	status = "okay";
};

/* UART For BT */
&uart2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart2>;
	uart-has-rtscts;
	status = "okay";
};

/* UART For WWAN/Modem */
&uart3 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart3>;
	uart-has-rtscts;
	status = "okay";
};

/* UART For RS-485#P11*/
&uart4 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart4>;
	uart-has-rtscts;
	status = "okay";
};

/* UART For RS-485#P12*/
&uart5 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart5>;
	status = "okay";
};

/* UART For TTL-232#P15/P19*/
&uart6 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart6>;
	status = "okay";
};

/* Wifi SDIO */
&usdhc2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc2>;
	vmmc-supply = <&reg_wifi_power>;
	vqmmc-supply = <&reg_wf_1v8>;
	bus-width = <4>;
	non-removable;
	keep-power-in-suspend;
	enable-sdio-wakeup;
	status = "okay";

	wifi@1 {
		compatible = "brcm,bcm4329-fmac";
		reg = <1>;
		interrupt-parent = <&gpio2>;
		interrupts = <6 IRQ_TYPE_EDGE_FALLING>;
		interrupt-names = "host-wake";
	};
};

